# Cell Separation Module

This module provides tools for yeast cell classification and division line prediction using deep learning approaches.

## Module Overview

The module contains two main workflows:

### 1. Cell Classification (Normal vs Budding)
- **Purpose**: Binary classification of individual yeast cells
- **Input**: Cell masks from dic_masks
- **Output**: Classification labels (0=Normal, 1=Budding)

### 2. Dividing Line Prediction  
- **Purpose**: Predict division lines to separate mother-daughter cell pairs
- **Input**: Combined cell masks
- **Output**: Binary dividing line masks for cell separation

## Quick Start

### Cell Classification Pipeline

1. **Generate classification training data:**
```bash
python cell_classification_processor_fixed.py --data_root data --output_dir classification_data
```

2. **Train classification model:**
```bash
python cell_classification_model.py --data_dir classification_data --epochs 200 --batch_size 128
```

### Dividing Line Prediction Pipeline

1. **Generate dividing line training data:**
```bash
python data_processor_dividing_line.py --data_root data --output_dir processed_dividing_line_data
```

2. **Train U-Net model:**
```bash
python train_dividing_line_unet.py --data-dir processed_dividing_line_data --epochs 500 --lr 5e-5 --batch_size 32
```

## Expected Data Structure

```
data/
├── dic_masks/          # Ground truth cell masks
├── divided_masks/      # Separated cell masks, generated by mask editor 
└── divided_outlines/   # Generated by mask editor 
```

## Output Models

- **Classification**: `classification_models/best_f1_model.pth`
- **Dividing Line**: `dividing_line_models/best_iou_model.pth`
